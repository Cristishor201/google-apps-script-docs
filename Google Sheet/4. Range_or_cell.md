# Range or cell

In Google Apps Script, avem Range sau Cells, insa de cele mai multe ori metodele care functioneaza pt range vor functiona si pt cells. Asta pentru ca range-ul nu este altceva decat o selectie de mai multe cells.

## Tipuri de `getRange()`

- `getRange("A1:C3")`
- `getRange(1, 1, 3, 3)` - (row_in, col_in, num_rows, num_cols)
- `getRange(namedArea)` - namedArea = selectie salvata pe un *range* sau *cell* din google sheet

> [!NOTE]
> `getRange("A1")` se poate folosi pt cell

### GET

#### Get cell

```js
var range = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName).getRange(<range>);

range.getValue(); // valoare simpla
```

#### Get range

```js
var range = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName).getRange(<range>);

range.getValues(); // 2d array [[1, 2, 3], [1, 2, 3], [1, 2, 3]] - in care array principal este pt fiecare linie
```

<hr>

### SET

#### Set cell

```js
var range = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName).getRange(<range>);

range.setValue(value); // variabila
```

> [!NOTE]
> Google Apps Script dureaza prea mult daca scrie multe casute individuale

#### Set range

```js
var range = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName).getRange(<range>);

range.setValues([[1, 2, 3], [4, 5, 6], [7, 8, 9]]); // 2d array in care array principal este pt fiecare linie
```

> [!IMPORTANT] 
> dimensiunea de la `getRange()` trebuie sa se potriveasca cu dimensiunea de la `setValues()`

<hr>

## GET - selectie (range) linie de inceput & num_linii_span

```
var range = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName).getRange("A2:B10");

range.getRow(); // 2
range.getNumRows(); // 8

range.getColumn(); // 1
```

## sters continut

```js
var range = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName).getRange("A2:B10");

range.clearContent(); // This clears the data in the cells but leaves the cells themselves.
```

## GET - data zi scurta

In javascript, la citire se ia tot formatul de data, in loc de ceva simplu

![date long format](/Google%20Sheet/_img/4/date_format.png)

de aceea vom prelua range / cell, asa cum este afisat in celula

```js
getRange('A1').getDisplayValue(); // cell
getRange('A1:C3').getDisplayValues(); // range
```

> [!WARNING]
> Daca un utilizator va schimba formatul in foaie in `MM/dd/yy`, acesta se va schimba si in script

